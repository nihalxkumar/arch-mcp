FROM python:3.12-slim-bookworm

WORKDIR /app

ENV PYTHONDONTWRITEBYTECODE=1
ENV PYTHONUNBUFFERED=1

RUN pip install uv

COPY . .

# Install package with HTTP dependencies for Smithery
RUN uv pip install --system ".[http]"

# Expose port for HTTP server (Smithery sets PORT env var, default 8080)
EXPOSE 8080

# Run HTTP server for Smithery
CMD ["arch-ops-server-http"]
